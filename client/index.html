<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="referrer" content="no-referrer">
<title>PreTTY Workbench</title>
<style>
*{font-family:"Andika"}

*{box-sizing:border-box}

html{height:100%; margin:0; padding:0}
body{height:100%; margin:0; padding:0}

#app{width:100%; height:100%; display:grid; grid-template-rows: max-content 1fr;}
#actions{width:100%; padding: 0.0rem; padding-left:0.5rem}
input{margin-top:0.5rem; margin-bottom:0.5rem; margin-right:0.25rem}
#main
{
  display:flex;
  height: 100%;
}

#source_editor
{
  width: max-content;
  border: 1px solid;
  overflow: auto;
  padding: 0.5rem;
  margin: 0px;
  flex: 0 1 auto;
  resize: horizontal;
  white-space: pre;
  tab-size: 4;
}

#output_frame
{
  min-width: min-content;
  width: max-content;
  margin: 0px;
  border: 1px solid;
  overflow: auto;
  padding: 0rem;
  resize: horizontal;
  flex: 1 0 auto;
}


textarea{font-family:"Cascadia code"; font-size:14px}
</style>
<script>
window.onbeforeunload = function()
{
	var req = new XMLHttpRequest();
	req.open("GET", "/!shutdown?api_key=$api_key");
	req.setRequestHeader("Content-Type", "application/json");
	req.send(JSON.stringify({}));
}

function source_editor_key_handler(e)
{
	if(e.key === "Tab" && !e.altKey && !e.ctrlKey)
	{
		e.preventDefault();
		const textArea = e.currentTarget;
		if(!e.shiftKey)
		{ textArea.setRangeText("\t", textArea.selectionStart, textArea.selectionEnd, "end"); }
	}
	else
	if(e.key === "Enter" && e.ctrlKey)
	{
		document.getElementById("build_and_run").click();
	}
	else
	if(e.key === "ArrowRight" && e.ctrlKey)
	{
		e.preventDefault();
		document.getElementById("build_and_run").click();
		document.getElementById("source_editor").style.display = "none";
		document.getElementById("output_frame").style.display = "block";
		document.getElementById("output_frame").style.width = "100%";
	}
	else
	if(e.key === "ArrowLeft" && e.ctrlKey)
	{
		document.getElementById("source_editor").style.display = "block";
		document.getElementById("source_editor").style.width = "100%";
		document.getElementById("source_editor").focus();
		document.getElementById("output_frame").style.display = "none";
	}
}

function document_on_key_down(e)
{
	if(e.key === "ArrowRight" && e.ctrlKey)
	{
		e.preventDefault();
		document.getElementById("build_and_run").click();
		document.getElementById("source_editor").style.display = "none";
		document.getElementById("output_frame").style.display = "block";
		document.getElementById("output_frame").style.width = "100%";
	}
	else
	if(e.key === "ArrowLeft" && e.ctrlKey)
	{
		e.preventDefault();
		document.getElementById("source_editor").style.display = "block";
		document.getElementById("source_editor").style.width = "100%";
		document.getElementById("output_frame").style.display = "none";
		document.getElementById("source_editor").focus();
	}
}

function set_panel_size(e)
{
  console.log("Hej");
  document.getElementById("source_editor").style.width = "50%";
}

</script>
</head>
<body onload="set_panel_size(event)" onkeydown="document_on_key_down(event)">
<div id="app">
	<form target="output" id="actions" method="post" enctype="multipart/form-data">
		<input type="submit" id="build_and_run" value="Build and run" formaction="/build_and_run">
		<input type="reset" id="load_example" value="Load example">
		<input type="submit" id="shutdown" value="Shutdown" formaction="/shutdown">
		<input type="hidden" name="api_key" value="$api_key">
	</form>

	<div id="main">
		<textarea id="source_editor" name="source" form="actions" onkeydown="source_editor_key_handler(event)">
#include &lt;pretty/base.hpp&gt;
#include &lt;pretty/annotations.hpp&gt;

#include &lt;numbers&gt;
#include &lt;map&gt;
#include &lt;vector&gt;

int main()
{
	print(pretty::section{"Hello, World"});
	print(pretty::paragraph{"This paragraph is formatted using ",
		pretty::code{"PreTTY"}, ". When formatting text with PreTTY it is possible to usecan use ",
		pretty::code{"code"}, ", ", pretty::emph{"emph"}, ", and ",
		pretty::link{.href="https://en.wikipedia.org/wiki/Hyperlink", .caption="hyperlinks"}, "."
	});

	print(pretty::subsection{"Printing content of std containers"});
	print(pretty::paragraph{"Any container can be printed as so:"});

	std::array&lt;int, 5&gt; some_ints{1, 2, 3, 4, 5};
	pretty::print(some_ints);

	print(pretty::paragraph{"An array of floats"});

	std::array&lt;float, 5&gt; some_floats{0.0f,
		1.0f,
 		std::numbers::phi_v&lt;float&gt;,
		std::numbers::e_v&lt;float&gt;,
		std::numbers::pi_v&lt;float&gt;};
	pretty::print(some_floats);

	print(pretty::paragraph{"Double gives some more digits"});
	std::array&lt;double, 5&gt; some_doubles{0.0,
		1.0,
 		std::numbers::phi_v&lt;double&gt;,
		std::numbers::e_v&lt;double&gt;,
		std::numbers::pi_v&lt;double&gt;};
	pretty::print(some_doubles);

	print(pretty::paragraph{"A pair is written as a table"});
	pretty::print(std::pair{"π", std::numbers::pi_v&lt;double&gt;});

	print(pretty::paragraph{"This is useful in case there is a long description:"});
	pretty::print(std::pair{"π", "The number π (/paɪ/; spelled out as \"pi\") is a mathematical constant that is the ratio of a circle's circumference to its diameter, approximately equal to 3.14159."});

	print(pretty::paragraph{"As pairs, any container whose value_type resolves to a pair is printed as a table:"});

	using map_types = std::variant&lt;std::map&lt;std::string, int&gt;, std::vector&lt;std::pair&lt;std::string, int&gt;&gt;&gt;;

	pretty::print(
		std::map&lt;std::string, map_types&gt;
		{
			{"A map", std::map&lt;std::string, int&gt;{{"Key 1", 12}, {"Key 2", 45}}},
			{"An vector of pairs", std::vector&lt;std::pair&lt;std::string, int&gt;&gt;{{"Key 3", 212}, {"Key 4", 145}}}
		}
	);

	print(pretty::paragraph{"The example above also shows that it is possible to use nested containers"});

	print(pretty::subsection{"\"Debug\" output"});

	print(pretty::paragraph{"Use ", pretty::code{"PRETTY_PRINT_EXPR"}, " to print the value of an expression:"});

	PRETTY_PRINT_EXPR(4*5);
}
</textarea>

		<iframe name="output" src="default.html?api_key=$api_key" id="output_frame"></iframe>
	</div>
</div>
</body>
</html>