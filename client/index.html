<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>PreTTY Workbench</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="">
<style>
*{font-family:"Andika"}

*{box-sizing:border-box}

html{height:100%; margin:0; padding:0}
body{height:100%; margin:0; padding:0}

#app{width:100%; height:100%; display:grid; grid-template-rows: max-content 1fr;}
#actions{width:100%}
#main
{
  display:flex;
  height: 100%;
}

#source_editor
{
  width: max-content;
  border: 1px solid;
  overflow: auto;
  padding: 0.5rem;

  flex: 0 1 auto;
  resize: horizontal;
  white-space: pre;

  tab-size: 4;
}

#output_frame
{
  min-width: min-content;
  width: max-content;
  border: 1px solid;
  overflow: auto;
  padding: 0rem;
  resize: horizontal;

  flex: 1 0 auto;
}


textarea{font-family:"Cascadia code"; font-size:14px}
</style>
<script>
window.onbeforeunload = function()
{
  var req = new XMLHttpRequest();
  req.open("POST", "/shutdown");
  req.setRequestHeader("Content-Type", "application/json");
  req.send(JSON.stringify({}));
}


function source_editor_key_handler(e)
{
  if(e.key === "Tab" && !e.altKey && !e.ctrlKey)
  {
    e.preventDefault();
    const textArea = e.currentTarget;
    if(!e.shiftKey)
    { textArea.setRangeText("\t", textArea.selectionStart, textArea.selectionEnd, "end"); }
  }

  if(e.key === "Enter" && e.ctrlKey)
  {
    document.getElementById("build-and-run").click();
  }
}

</script>
<body>
<div id="app">
<form action="/formaction" target="output" id="actions" method="post" enctype="multipart/form-data">
<input type="submit" id="build-and-run" value="Build and run">
</form>

<div id="main">
<textarea id="source_editor" name="source" form="actions" onkeydown="source_editor_key_handler(event)">
</textarea>

<iframe name="output" src="default.html" id="output_frame">
</iframe>
</div>
</div>
</body>
</html>